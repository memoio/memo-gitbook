# MEFS

## 引言

MEFS（MEMO 是一个围绕区块链构建的大规模去中心化数据存储系统，具有高安全性和可靠性。它是一种新一代的区块链去中心化云存储协议，组织全球边缘存储节点为用户提供安全、可靠和高可用的存储服务。

MEFS（MEMO 文件系统）是 MEMO 的文件存储系统。

![memo](../../images/mefs/memo-icon.png)

MEMO 是由 MEMO Labs 开发的新一代区块链去中心化云存储协议。我们的使命是为 Web3.0 构建可靠的基础设施。为了实现高可扩展性和可用性，MEMO 在数据分层、验证、容错和恢复机制方面进行了大量创新。MEMO 在区块链云存储方面取得了技术突破，采用了新的架构和多项创新。

MEMO 设计了三种用户角色：用户，即存储空间用户；提供者，即存储空间提供者；守护者，即协调管理人。这三个相互联系的角色由智能合约驱动，相互制约。

MEMO 可以分为三个基于功能的角色层：结算、验证和存储。结算层通过聚合订单信息并在链上处理结算，将每个订单的金额发送给存储节点的提供者。验证层在链下进行。守护者节点挑战提供者节点，验证证明的结果，并决定是否向提供者节点发放提款凭证。验证层的所有过程都将通过同一层的节点进行，并经过拜占庭容错共识。存储层由大量的分散的提供者节点组成，它们存储真实的用户数据，并定期向验证层提交存储证明。

以下文章将帮助您了解更多信息。

什么是 MEMO？

[Memoriae — 基于区块链的去中心化云存储的下一代](https://memolabs.medium.com/memoriae-next-generation-of-decentralized-cloud-storage-based-on-blockchain-9151ab8c1aaa)

Roles：

[构建自治存储系统：Memoriae 中的角色设计](https://memolabs.medium.com/build-an-autonomous-storage-system-role-design-in-memoriae-f724c405ddc)

[Memoriae 系统节点匹配](https://memolabs.medium.com/memoriae-system-node-matching-d246fca41009)

技术：

[MEMO 去中心化云存储系统的多级容错机制设计](https://memolabs.medium.com/multilevel-fault-tolerant-mechanism-design-for-memo-decentralized-cloud-storage-system-f3c585eb401d)

[MEMO 原始数据恢复策略：风险感知故障识别 (RAFI)](https://medium.com/memolabs/the-risk-aware-failure-identification-rafi-strategy-of-memo-decentralized-cloud-storage-system-6c5990ec8cb3)

![memo-picture](../../images/mefs/memoPic.png)

### 注册认证令牌

用户点击 Memoriae 钱包（开发中）中的链接以获取测试令牌，系统将向用户发送 10 Memo 的测试令牌。当用户的测试余额不低于 10 Memo 时，他们将无法再次申请测试令牌。

发送电子邮件至 [sup@memolabs.org](mailto:sup@memolabs.org) 申请测试令牌

电子邮件主题：申请测试令牌

电子邮件内容：账户地址（例如 0x...），角色（提供者或守护者或用户）

### 互动论坛

对去中心化数据存储系统感兴趣的人欢迎加入 Memo 社区并参与互动！

我们的 GITHUB 网址是：

<https://github.com/memoio/testnet/issues>

我们的 TWITTER 网址 是：

<https://twitter.com/Memo_Labs>

## 特点和优势

去中心化存储。 用户上传源文件后，Memo 系统可以将数据分发到多个存储节点，并对外提供统一标准化的接口。当目标用户发起下载请求时，最近的节点通过最近的节点下载片段并完整地提供给用户。网络中提供多个图像或副本，大大提高了访问速度和稳定性。

全球共享。 多个 Memo 设备可以形成集群效应，实现全球数据共享、统一存储空间管理和云存储平台的自动负载均衡。文件可以跨区域和网络分布，支持整个网络的数据存储和高效使用，按需扩展以满足用户对高速扩展的需求。

数据安全。 数据存储功能是 Memo 的基石，数据的安全性和可靠性是数据存储功能的基石。Memo 的数据隐私政策要求在写入边缘存储设备之前，源客户端的数据必须使用用户密钥进行加密。此外，访问控制机制确保数据可以由其所有者或其维护者和存储协作访问，而不会被其他用户或无关的维护者和存储者访问。

系统可靠性。 Memo 确保可靠性的目标是防止用户设备、维护设备或边缘存储设备失败时数据丢失。可以使用复制、擦除编码等数据冗余技术来确保边缘存储设备上存储的数据的可靠性。

原始数据恢复方法 - RAFI。除了数据冗余机制外，数据修复方法也是决定数据可靠性的重要因素。Memo 的原始数据恢复方法 RAFI 用于进一步提高边缘存储设备中存储数据的可靠性。RAFI 技术可以优化边缘存储空间，并更多地保证数据的安全性和系统的稳定性。通过实时查询，可以快速发现高风险的数据丢失，有效地缩短数据修复的总时间并提高性能。

### 与其他区块链存储项目相比，MEMO 有什么特别之处？

MEMO 是一个基于区块链的去中心化云存储系统。它与一些旨在生产区块的项目不同，这些项目的存储数据量直接与区块的计算能力相关；它也不同于伪去中心化的分布式存储项目，这些项目中的一个或几个节点通常承担“中心节点”的功能。

## Memo 系统的角色设计

在 Memo 分布式云存储系统中，每个用户可以根据自己需要注册一个角色。系统角色包括用户、守护者和提供者。如果是存储需求方，则注册为用户；如果是设备提供方，则注册为提供者；如果只提供信息管理服务，则注册为守护者。本文将从整个系统运行的角度解释每个角色的设计原则。

这三个角色的基本职责如下：

1、用户：是系统中的存储服务消费者，提出存储需求并上传数据

2、守护者：是系统中的管理协调员，负责信息中介和管理功能。

3、提供者：是系统中的存储设备提供者，为用户提供存储空间。

在这三个角色中，用户和提供者是存储服务的供需双方，用户也是系统中的最终用户。简而言之，用户使用 Memo 系统中的存储空间，守护者为用户找到合适的存储节点，存储节点提供者为用户提供数据存储。守护者相当于招聘平台上的猎头或房地产交易平台上的中介。

### 角色概念

#### 1、用户

由于系统中的最终用户是用户，因此需要为存储服务支付相应的存储费用，因此每个服务请求都由用户发起。

当用户提出存储服务需求时，应包括以下要素：存储空间大小、存储时长；提供者和守护者的数量；以及所需的存储单位价格。

因为只有在设置上述参数后，守护者才能检索和匹配相应的存储节点。同时，在去中心化云存储系统中，存储节点越多，数据越安全，但存储节点越多，支付的费用越高。因此，用户需要自己确定存储节点提供者和中间管理者守护者的数量，并需要在成本和数据安全之间找到平衡。

用户不仅需要支付存储服务费用，当他们需要从提供者下载数据时，还需要支付下载费用，因为下载操作将给提供者带来流量和设备的消耗。

由于用户是最终支付方，系统对这个角色没有设置特别限制，因为如果用户不支付，提供者和守护者将停止服务。但对于其他两个角色，提供者和守护者，系统为他们设置了相应的惩罚措施，将在下文讨论。

#### 2、守护者

##### 基本功能

守护者是系统中重要的中介角色。它承担信息中介和管理功能，并从用户支付的存储费用中提取管理佣金。

作为信息中介，其基本功能是匹配信息，即匹配需求方和供需方之间的信息。当用户提出存储需求时，守护者将根据用户的要求找到与自己连接的提供者，并匹配合适的存储节点。

除了基本的信息匹配外，守护者的管理功能主要体现在参与挑战和触发支付上。守护者定期发起并参与对提供者的挑战。其目的是验证提供者是否完整存储数据，即验证提供者的真伪和诚信。根据挑战结果，我们可以了解每个提供者在这段时间内为用户有效存储了多少和多长时间的数据，这将作为用户后续支付的依据。

此外，守护者另一个重要的功能是触发存储费用的支付。支付不是由支付方用户或支付方提供者触发的，而是由中间人守护者触发的。这主要是为了增加系统的公平性。由中间人守护者触发可以减少欺诈行为的概率。

##### 惩罚机制

守护者作为中介，参与系统的管理。虽然它在一定程度上可以解决分布式存储系统存储供需的信任问题，但认为守护者本身可能缺乏诚信，例如不及时挑战存储的数据，不及时触发支付。为了触发支付，Memo 因此为角色设计了惩罚措施。惩罚机制的存在可以在一定程度上确保系统的良性运行和社区的健康发展。

因此，系统规定，当账户注册为守护者时，必须质押费用。

这个费用可以由账户退还，也可以在账户违反系统规定时扣除。如果账户质押的金额不足，或者没有质押存款金额，那么就没有诚信背书，账户的守护者角色无法建立。关于守护者质押的金额，何时扣除罚款以及扣除多少可以链下确定。

通常，当账户严重违反系统规定时，将对账户进行处罚。如果守护者无法按时进行存储数据的空间-时间挑战，同步空间-时间挑战的结果并报告空间-时间挑战的结果很长时间，那么系统将禁止该账户。一旦账户被禁止，它将永远不会再成为守护者。

当守护者被禁用时，如果守护者质押的余额不为 0，则该余额可以如下处理：归还给账户；转移给部署角色合约的角色管理员；转移给违反系统规定的守护者其他受影响的账户包括用户、守护者和提供者。

#### 3、提供者

##### 基本功能

提供者是系统中提供存储空间的一方。它为用户提供存储服务，并从用户那里获得支付的费用。提供者上线后，需要说明自己的存储情况，包括可用的存储空间、存储时长和所需的存储单价。提供者说明自己的情况后，守护者可以根据用户和提供者的情况匹配，然后将匹配的提供者信息发送给用户，以便用户、守护者和提供者形成一个存储服务。

像守护者一样，提供者也有触发支付的功能，只不过守护者触发的是存储费用的支付，而提供者触发的是下载费用的支付。这是因为存储费用的验证需要中间管理者守护者的参与，而下载费用的验证不需要中间管理者的参与。

##### 惩罚机制
上述提到了对守护者的违规行为进行惩罚。对于提供者，系统也设计了奖励和惩罚机制，因为提供者可能会有问题，比如数据损坏但不恢复，长期不响应用户下载数据请求或守护者挑战。这不仅会破坏用户的数据，还会严重影响用户体验。

因此，对于提供者角色，在申请角色时也需要质押费用。一旦提供者违反系统规则，系统将触发相应的惩罚来扣除质押的金额。

##### 惩罚合约部署者：第三方合约管理员 Admin
从系统设计的角度来看，每个角色都可以在 Memo 系统中获得收益。由于用户是最终消费者，惩罚措施主要是针对收集角色，即守护者和提供者，系统角色功能的实现和角色之间的互动是通过智能合约实现的，因此惩罚也是通过智能合约实现的。

采用基于合约的惩罚机制的原因是：在低信誉环境中部署的去中心化系统，没有具体的组织决策，实施奖惩，而合约具有所有事先制定的条款和执行流程，并且是在计算机的绝对控制下执行的优势。此外，智能合约编译后部署在区块链上，并由虚拟机执行，区块链上的每个节点都会运行智能合约的过程，因此智能合约的执行过程和执行可以实现分布式监督和仲裁的结果。

借助智能合约的这些优势，可以事先在合约中规定提供者和守护者的惩罚机制。至于谁触发智能合约的质押扣除功能的问题，可用的解决方案包括：由用户触发；由守护者触发；由其他提供者触发；或由角色合约部署者触发。系统中的任何角色都不适合触发提供者和守护者的质押扣除功能。原因是他们三个在存储服务中相互关联。提供者通过为用户存储数据获得收入，守护者通过帮助用户挑战验证数据和收集信息获得收入。因此，触发质押扣除功能的权力应该转移到一个无关的第三方，即角色合约部署者，这里称为合约管理员 Admin。Admin 部署惩罚合约，这也是 Memo 系统为了实现公平交易而设计的一种制衡机制。

## 每个角色的要求

### 硬件要求

守护者和提供者需要长时间在线

### 系统要求

确保 keystore 文件的安全

### 用户

推荐配置：

推荐配置：4 核心，8G 内存，20Mbps 带宽；

外部网络 IP，端口 4001 可用；

Docker 环境；

### 守护者

推荐配置：

4 核心处理器，8G 运行内存，200GB 存储空间，20Mbps 网络带宽；

互联网 IP 地址，端口 4001 已开放；

Docker 环境；

### 提供者

推荐配置：

4 核心，8G 内存，1TB 存储，20Mbps 带宽；

外部网络 IP，端口 4001 可用；

Docker 环境；

## 关于 RAFI

RAFI 作为一种新的风险感知故障识别策略，它使用不同的时间阈值来识别不同数量失败块的条带故障，以期在更短的识别时间内提高整体数据的可靠性和可用性。

[learn more](https://www.usenix.org/conference/atc18/presentation/fang)
